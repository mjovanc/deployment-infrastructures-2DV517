---
  - name: Create instances
    hosts: localhost
    roles:
      - openstack_wordpress_create_instance
      - openstack_mysql_create_instances
    tasks:
    - name: Wait for interface to attach
      pause:
        seconds: 60
  
#  - name: Common configuration for all hosts
#    hosts: wordpress:mysql
#    become: yes
#
#    roles:
#      - common

  - name: Configure MySQL master database
    hosts: mysqlmaster
    become: yes
    roles:
        - mysql_master

  - name: Configure MySQL slave database
    hosts: mysqlslave
    become: yes
    roles:
        - mysql_slave

  - name: Configure wordpress configurations on master database
    hosts: mysqlmaster
    become: yes
    roles:
        - wp_db

  - name: Configure Wordpress frontend
    hosts: wordpress
    become: yes
    roles:
      - wp_frontend
